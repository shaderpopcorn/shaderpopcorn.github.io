<link type="text/css" rel="stylesheet" href="../css/code.css" media="all" />
<div class="included">
    // KODELIFE

    #version 150

    uniform float time;
    uniform vec2 resolution;
    uniform vec2 mouse;

    float PI = 3.1415;

    in VertexData{vec4 v_position; vec3 v_normal; vec2 v_texcoord;} inData;
    out vec4 fragColor;

    float Xor(float a, float b){return a*(1.-b)+b*(1.-a);}

    float Sun(vec2 uv, vec2 rv){
        float gv = uv.x*floor(mouse.x*28.);
        float m = min(fract(gv),fract(1.-gv));
        return smoothstep(.299,.3,m) + smoothstep(.05,.0499,rv.y);}

    float sdBox(vec2 p, vec2 b){
        vec2 c = abs(p)-b;
        float d = length(max(c,.1)) + min(max(c.x,c.y),.1);
        return smoothstep(.199,.2,d);}

    vec4 Shader(vec2 uv, vec2 mouse){
        vec2 uvA = uv;
        vec2 uvB = uv;
        uvA.x -= sin(time/10.)/1.*cos(time/5.)/4.;
        uvA.y -= sin(time/10.)/2.*sin(time/10.)/3.;
        uvB.x -= sin(time/10.)/3.*sin(time/15.)/2.;
        uvB.y -= sin(time/10.)/4.*cos(time/20.)/1.;

        float a = sdBox(uvA, vec2(.4,.1));
        float b = sdBox(uvB, vec2(.2,.2));

        uv -= vec2(mouse.x*2.-1.,sin(mouse.x*3.1415)*.55);
        uv.y += .575;
        float an = PI+time/5.;
        uv *= mat2(cos(an),-sin(an),sin(an),cos(an));
        vec2 rv = vec2(atan(uv.x,uv.y),length(uv));
        uv = vec2(rv.x/6.2831+.5,rv.y);

        float s = Sun(uv, rv);
        float c = Xor(s, a);
        float d = Xor(b, c);

        return vec4(d);}

    void main(void){
        vec2 uv = (gl_FragCoord.xy-.5*resolution.xy)/resolution.y;
        vec4 col = vec4(0.);

        col = Shader(uv, mouse);

        fragColor = col;}

</div>
