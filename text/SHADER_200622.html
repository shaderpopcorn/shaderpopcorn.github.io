<link type="text/css" rel="stylesheet" href="../css/text.css" media="all" />
<div class="included">
    // KODELIFE

    #version 150

    uniform float time;
    uniform vec2 resolution;
    uniform vec2 mouse;

    float PI = 3.1415;
    float PI2 = 6.283;


    in VertexData{vec4 v_position;vec3 v_normal;vec2 v_texcoord;} inData;
    out vec4 fragColor;

    float hexDist(vec2 uv){
        uv = abs(uv);
        float d = dot(uv, normalize(vec2(1.,1.73)));
        d = max(d, uv.x);
        return d;}

    void main(void){
        vec2 uv = (gl_FragCoord.xy -.5*resolution.xy)/resolution.y;
        vec4 col = vec4(.0);

        uv *= 5.;

        float an = PI/2.;
        uv *= mat2(cos(an),-sin(an),sin(an),cos(an));

        vec2 r = vec2(1.,1.73);
        vec2 h = r*.5;

        vec2 gv;
        vec2 gv1 = mod(uv, r)-h;
        vec2 gv2 = mod(uv-h, r)-h;

        if(length(gv1) < length(gv2)) gv = gv1;
        else gv = gv2;

        float x = atan(gv.x,gv.y)/PI2+.5;
        float y = 0.;

        vec2 gvA = gv;
        vec2 gvB = gv;
        vec2 gvC = gv;

        float zo = (mouse.x+.1)*30.;

        if(x>0. && x<1./3.) {
            gvA += vec2(.25,.14);
            float anA = PI/3.;
            gvA *= mat2(cos(anA),-sin(anA),sin(anA),cos(anA));
            gvA *= zo;
            gvA.y = abs(gvA.y);
            gvA.y -= time;
            float d = sin(gvA.x+gvA.y*1.73);
            float m = smoothstep(.1,.0,d);
            col += vec4(m);
        }

        if(x>1./3. && x<1./3.*2.) {
            gvB += vec2(.0,-.2925);
            float aB = PI/1.;
            gvB *= mat2(cos(aB),-sin(aB),sin(aB),cos(aB));
            gvB *= zo;
            gvB.y = abs(gvB.y);
            gvB.y -= time;
            float d = sin(gvB.x+gvB.y*1.73);
            float m = smoothstep(.1,.0,d);
            col += vec4(m);
        }

        if(x>1./3.*2. && x<1.) {
            gvC += vec2(-.25,.14);
            float aC = 1.-PI/1.53;
            gvC *= mat2(cos(aC),-sin(aC),sin(aC),cos(aC));
            gvC *= zo;
            gvC.y = abs(gvC.y);
            gvC.y -= time;
            float d = sin(gvC.x+gvC.y*1.73);
            float m = smoothstep(.1,.0,d);
            col += vec4(m);
        }

        fragColor = col;
    }
</div>
